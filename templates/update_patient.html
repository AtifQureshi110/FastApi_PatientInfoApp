<!DOCTYPE html>
<html>
<head>
    <title>Patient Form</title>
    <link rel="stylesheet" href="/static/css/style.css?v=1">
    <link rel="stylesheet" href="/static/css/shared.css">
</head>

<body>
    <!-- Navigation Bar -->
    <div class="nav-right">
        <a href="/">Home</a>
        <a href="/form">Form</a>
        <a href="/update">Update</a>
    </div>
    <div class="container">
        <div class="form-container">
            <h2>Search Patient by ID</h2>
            <!-- First form to enter ID -->
            <form method="post" action="/search_patient">
                <label id="lb">Enter Patient ID:</label>
                <input type="text" name="id" required>
                <button type="submit">Search</button>
            </form>
            <!-- ðŸ”´ Show error if patient not found -->
            {% if error %}
                <div class="alert alert-danger fw-bold" role="alert">
                    {{ error }}
                </div>
            {% endif %}            

            <!-- âœ… Show success message below search bar -->
            {% if message %}
                <div class="alert alert-success fw-bold" role="alert">
                    {{ message }}
                </div>
            {% endif %}

            <!-- {% if show_options_only %}
                <form method="post" action="/show_update_form" class="action-form">
                    <input type="hidden" name="id" value="{{ patient.id }}">
                    <button type="submit" name="action" value="update">Update</button>
                    <button type="submit" name="action" value="delete">Delete</button>
                </form>
            {% endif %} -->


            {% if show_options_only %}
                <form method="post" id="actionForm" class="action-form">
                    <input type="hidden" name="id" value="{{ patient.id }}">
                    <button type="submit" onclick="submitForm('update')">Update</button>
                    <button type="submit" onclick="submitForm('delete')">Delete</button>
                </form>

                <script>
                    function submitForm(action) {
                        const form = document.getElementById('actionForm');
                        if (action === 'update') {
                            form.action = '/show_update_form';
                        } else if (action === 'delete') {
                            form.action = '/delete_patient';
                        }
                    }
                </script>
            {% endif %}


            <!-- If patient is found, show the update form -->
            {% if show_form %}
                <h3>Update Patient Details</h3>    <!-- 03453573073 sirimran learning deck -->
                <form method="post" action="/update_patient">
                    <input type="hidden" name="id" value="{{ patient.id }}">

                    <div class="form-group">
                        <label>Name:</label>
                        <input type="text" name="name" value="{{ patient.name }}" required>
                    </div>

                    <div class="form-group">
                        <label>Age:</label>
                        <input type="number" name="age" value="{{ patient.age }}" required>
                    </div>

                    <div class="form-group">
                        <label>Weight:</label>
                        <input type="number" name="weight" value="{{ patient.weight }}" required>
                    </div>

                    <div class="form-group">
                        <label>Married:</label>
                        <input type="checkbox" name="married" {% if patient.married %}checked{% endif %}>
                    </div>

                    <div class="form-group">
                        <label>Allergies (comma-separated):</label>
                        <input type="text" name="allergies" value="{{ patient.allergies | join(',') }}">
                    </div>

                    <div class="form-group">
                        <label>Contact:</label>
                        <input type="text" name="contact_details" value="{{ patient.contact_details }}">
                    </div>

                    <div class="form-group">
                        <label>Email:</label>
                        <input type="email" name="email" value="{{ patient.email }}">
                    </div>

                    <div class="form-group">
                        <label>LinkedIn:</label>
                        <input type="text" name="linkedin_url" value="{{ patient.linkedin_url }}">
                    </div>

                    <div class="form-group">
                        <label>Height:</label>
                        <input type="number" name="height" value="{{ patient.height }}">
                    </div>

                    <div class="form-group">
                        <button type="submit">Update</button>
                    </div>
                </form>
            {% endif %}
        </div>
    </div>
</body>
</html>

